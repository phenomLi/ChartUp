"use strict";var __extends=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])};return function(i,e){function n(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),ChartUp=function(t){var i={defaultColor:"#000",edge:[20,20],showLabel:!0},e=function(t){return Math.PI*(t/180)},n=function(t){return Math.max.apply(Math,t)},s=function(t){return Math.min.apply(Math,t)},r=new(function(){function t(){this.fn={},this.tempValue=[],this.version="0.0.2",this.configuration=i,this.fn={drawLine:function(t,i,e,n){return new o(t,i,e,n)},DrawArc:function(t,i,e,n){return void 0===n&&(n=!0),new a(t,i,e,n)},DrawRect:function(t,i,e,n){return void 0===n&&(n=!0),new h(t,i,e,!0)},animate:f}}return t.prototype.changeItem=function(t,i){var e=t.getAttribute("data-item"),n=null,s=0;i.items.map(function(t,i){t.label===e&&(s=i,n=t)}),t.className.indexOf("active")>-1?(t.classList.remove("active"),i.itemList.push(e),d(n,"set",function(){},i.chartIntance,this.tempValue)):(n.value instanceof Array?n.value[0]instanceof Array?this.tempValue=n.value.map(function(t){return t.slice(0)}):this.tempValue=n.value.slice(0):this.tempValue=n.value,t.classList.add("active"),d(n,"remove",function(){i.itemList.splice(i.itemList.indexOf(e),1),i.chartIntance.setRenderOption(i.chartIntance.config.itemList).render()},i.chartIntance))},t.prototype.createTagItem=function(t,e,n){if(!i.showLabel)return!1;var s=document.createElement("li"),r=document.createElement("span"),o=document.createElement("span"),a=this;s.setAttribute("data-item",e.label),r.classList.add("tag"),r.style.backgroundColor=e.color,o.classList.add("label"),o.innerHTML=e.label,s.appendChild(r),s.appendChild(o),s.addEventListener("click",function(t){a.changeItem(this,n)}),t.appendChild(s)},t.prototype.destoryTagItem=function(t,i){var e=null;i?[].slice.call(t.children).map(function(t){t.querySelector(".label").innerHTML===i&&(e=t)}):e=t.children[t.children.length-1],e&&t.removeChild(e)},t.prototype.addCondition=function(t,i){var e=this,n=document.createElement("h2"),s=document.createElement("canvas"),r=document.createElement("ul"),o=document.createElement("div");return t.classList.add("chartUp-container"),o.classList.add("comment"),n.innerHTML=i.title?i.title:"",o.innerHTML=i.comment?i.comment:"",r.classList.add("tag-con"),i.items.map(function(t){e.createTagItem(r,t,i)}),t.appendChild(n),t.appendChild(o),t.appendChild(s),t.appendChild(r),s.width=s.offsetWidth,s.height=s.offsetHeight,i.canvas=s,i.tagCon=r,i.canvasWidth=s.offsetWidth,i.canvasHeight=s.offsetHeight,s.getContext("2d")},t.prototype.config=function(t){this.configuration=Object.assign(this.configuration,t)},t.prototype.extend=function(t){return t.chartType?t.chartClass?void(this[t.chartType]=function(i,e){var n=document.querySelector(i);if(!n)return!1;var s=this.addCondition(n,e);return e.chartType=t.chartType,e.itemList=e.items.map(function(t){return t.label}),e.chartIntance=new t.chartClass(s,e).init(e.itemList),e.chartIntance}):(console.warn("'chartClass' option is required."),!1):(console.warn("'chartType' option is required."),!1)},t}()),o=function(){function t(t,i,e,n){this.g=null,this.currentPoint=[],this.color="",this.g=t,this.color=n,this.color&&(this.g.strokeStyle=this.color),this.g.beginPath(),this.g.moveTo(i,e),this.currentPoint=[i,e]}return t.prototype.reLine=function(t){this.color=t,this.g.stroke(),this.g.strokeStyle=this.color,this.g.beginPath(),this.g.moveTo(this.currentPoint[0],this.currentPoint[1])},t.prototype.next=function(t,i,e){return e&&this.reLine(e),this.g.lineTo(t,i),this.currentPoint=[t,i],this},t.prototype.paint=function(t){return this.g.stroke(),t.render(this.currentPoint[0],this.currentPoint[1],this.color),this.g.beginPath(),this.g.moveTo(this.currentPoint[0],this.currentPoint[1]),this},t.prototype.end=function(t,i,e,n){return void 0===e&&(e=!1),n&&this.reLine(n),e&&(this.g.fillStyle=n),this.g.lineTo(t,i),this.currentPoint=[t,i],e?this.g.fill():this.g.stroke(),this},t}(),a=function(){function t(t,i,n,s){void 0===s&&(s=!0),this.g=null,this.radius=0,this.startAngle=0,this.endAngle=0,this.isSoild=!0,this.x=0,this.y=0,this.isDrawCircle=!1,this.g=t,this.radius=i,this.startAngle=0,this.endAngle=e(n),this.isSoild=s,360===n&&(this.isDrawCircle=!0)}return t.prototype.next=function(t,i){return this.startAngle=this.endAngle,this.endAngle=this.endAngle+e(t),this.render(this.x,this.y,i),this},t.prototype.render=function(t,i,e){return this.x=t,this.y=i,e&&(this.isSoild?this.g.fillStyle=e:this.g.strokeStyle=e),this.g.beginPath(),!this.isDrawCircle&&this.g.moveTo(this.x,this.y),this.g.arc(this.x,this.y,this.radius,this.startAngle,this.endAngle),this.g.closePath(),this.isSoild?this.g.fill():this.g.stroke(),this},t}(),h=function(){function t(t,i,e,n){void 0===n&&(n=!0),this.g=null,this.width=0,this.height=0,this.isSoild=!0,this.g=t,this.isSoild=n,this.width=i,this.height=e}return t.prototype.render=function(t,i,e){e&&(this.isSoild?this.g.fillStyle=e:this.g.strokeStyle=e),this.g.beginPath(),this.g.rect(t,i,this.width,this.height),this.isSoild?this.g.fill():this.g.stroke()},t}(),l=function(){function t(t,i,e){this.g=null,this.config=null,this.items=[],this.margin=45,this.oX=0,this.oY=0,this.xOrigin=0,this.yOrigin=0,this.lX=0,this.lY=0,this.xEdge=0,this.yEdge=0,this.rxEdge=0,this.ryEdge=0,this.rxIntervals=[],this.ryIntervals=[],this.xIntervals=[],this.yIntervals=[],this.xCount=0,this.yCount=0,this.xInterval=0,this.yInterval=0,this.g=t,this.config=i,this.items=e,this.oX=this.margin,this.oY=this.config.canvasHeight-this.margin,this.lX=this.config.canvasWidth-this.oX-20-this.margin,this.lY=this.oY-20,this.rxEdge=this.oX+this.lX,this.ryEdge=this.oY-this.lY,this.xInterval=this.config.interval[0]?this.config.interval[0]:1,this.yInterval=this.config.interval[1]?this.config.interval[1]:this.config.interval;var n=this.getMax(this.items,"x"),s=this.getMax(this.items,"y"),r=Math.ceil(this.getMin(this.items,"x")),o=Math.ceil(this.getMin(this.items,"y"));this.xOrigin=r,this.yOrigin=o;var a=n-this.xOrigin,h=s-this.yOrigin;this.xCount=Math.floor(a/this.xInterval)+1,this.yCount=Math.floor(h/this.yInterval)+1,this.xEdge=this.xInterval*this.xCount+this.xOrigin,this.yEdge=this.yInterval*this.yCount+this.yOrigin;for(l=1;l<=this.xCount;l++){c=l*(this.lX/this.xCount);this.rxIntervals.push(this.oX+c),this.yIntervals.push(l*this.xInterval+this.xOrigin)}for(var l=1;l<=this.yCount;l++){var c=l*(this.lY/this.yCount);this.ryIntervals.push(this.oY-c),this.yIntervals.push(l*this.yInterval+this.yOrigin)}}return t.prototype.baseLineX=function(){var t=this.calc(0,0).y,i=this.calc(this.xOrigin,0).x;return this.g.save(),this.yOrigin<0&&new o(this.g,i,t,"#666").end(this.rxEdge,t),this.g.restore(),this},t.prototype.baseLineY=function(){var t=this.calc(0,0).x,i=this.calc(0,this.yOrigin).y;return this.g.save(),this.xOrigin<0&&new o(this.g,t,i,"#666").end(t,this.ryEdge),this.g.restore(),this},t.prototype.rightAngle=function(){return new o(this.g,this.margin,0).next(this.oX,this.oY).end(this.config.canvasWidth-this.margin,this.oY),this},t.prototype.setXIntervalPoint=function(){this.coordinateSystemText("("+this.xOrigin+", "+this.yOrigin+")",this.oX,this.oY+15);for(var t=1;t<=this.xCount;t++){var i=t*(this.lX/this.xCount);new o(this.g,this.oX+i,this.oY).end(this.oX+i,this.oY+5),this.coordinateSystemText(t*this.xInterval+this.xOrigin,this.oX+i,this.oY+15)}return this},t.prototype.setYIntervalPoint=function(){for(var t=1;t<=this.yCount;t++){var i=t*(this.lY/this.yCount);new o(this.g,this.oX-5,this.oY-i).end(this.oX,this.oY-i),this.coordinateSystemText(t*this.yInterval+this.yOrigin,this.oX-15,this.oY-i)}return this},t.prototype.coordinateSystemText=function(t,i,e){this.g.save(),this.g.textAlign="center",this.g.textBaseline="middle",this.g.fillText(t,i,e),this.g.restore()},t.prototype.calc=function(t,i){return{x:this.oX+(t-this.xOrigin)*this.lX/(this.xEdge-this.xOrigin),y:this.oY-(i-this.yOrigin)*this.lY/(this.yEdge-this.yOrigin)}},t.prototype.getMax=function(t,e){var s="x"===e?0:1;if(0===t.length)return i.edge[s];if("BaseChart"===this.config.chartType||"PointChart"===this.config.chartType)return n(t.map(function(t){return"function"==typeof t.value?i.edge[s]:n(t.value.map(function(t){return t[s]}))}));if("AreaChart"===this.config.chartType){for(var r=[],o=0,a=0;a<this.config.length;a++){for(var h=0;h<this.items.length;h++)o=this.items[h].value[a]+o;r.push(o),o=0}return n(r)}return n(this.items.map(function(t){return n(t.value)}))},t.prototype.getMin=function(t,i){var e=this,n="x"===i?0:1;if(0===t.length)return 0;if("BaseChart"===this.config.chartType||"PointChart"===this.config.chartType)return s(t.map(function(t){return"function"==typeof t.value?0:Math.ceil(s(t.value.map(function(t){return t[n]})))-e.config.interval[n]}));if("AreaChart"===this.config.chartType)return s(t[0].value);var r=s(this.items.map(function(t){return s(t.value)}));return r>0?0:r-Math.abs(r)},t}(),c=function(){function t(t,i,e){this.g=null,this.config=null,this.items=null,this.oX=0,this.oY=0,this.angleList=[],this.edge=0,this.max=0,this.count=0,this.g=t,this.config=i,this.items=e,this.oX=this.config.centerX,this.oY=this.config.centerY,this.max=this.getMax(this.items),this.count=Math.floor(this.max/this.config.interval)+1,this.edge=this.count*this.config.interval}return t.prototype.getAngleValue=function(t,i){var e=this,n=[],s=0,r=2*Math.PI/t.length,o=Math.PI/2;return t.map(function(t,a){s=a*r,n.push({x:e.oX+i*Math.cos(s+o),y:e.oY+i*Math.sin(s+o)})}),n},t.prototype.drawPolygon=function(){for(var t=[],i=0,e=null,n=0;n<this.count;n++){i=(this.edge-n*this.config.interval)*this.config.defaultRadius/this.edge,t=this.getAngleValue(this.config.index,i);for(var s=0;s<t.length;s++)e=s===t.length-1?e.next(t[s].x,t[s].y).end(t[0].x,t[0].y):0===s?new o(this.g,t[s].x,t[s].y,"#ddd"):e.next(t[s].x,t[s].y);0===n&&(this.angleList=t)}return this},t.prototype.fillPolygon=function(){var t=[],i=0,e=null;this.g.save();for(var n=0;n<this.count;n++){i=(this.edge-n*this.config.interval)*this.config.defaultRadius/this.edge,t=this.getAngleValue(this.config.index,i),this.g.fillStyle=n%2?"#eee":"#fff";for(var s=0;s<t.length;s++)e=s===t.length-1?e.next(t[s].x,t[s].y).end(t[0].x,t[0].y,n>0):0===s?new o(this.g,t[s].x,t[s].y,"#ddd"):e.next(t[s].x,t[s].y)}return this.g.restore(),this},t.prototype.drawRay=function(){var t=this;return this.angleList.map(function(i){new o(t.g,t.oX,t.oY,"#ddd").end(i.x,i.y)}),this},t.prototype.drawText=function(){var t=this;return this.g.save(),this.g.textAlign="center",this.angleList.map(function(i,e){var n=i.x,s=i.y;i.x>t.oX&&(n=i.x+20),i.x<t.oX&&(n=i.x-20),i.y>t.oY&&(s=i.y+20),i.y<t.oY&&(s=i.y-20),t.g.fillText(t.config.index[e],n,s)}),this.g.restore(),this},t.prototype.getMax=function(t){return 0===t.length?i.edge[0]:n(t.map(function(t){return n(t.value)}))},t.prototype.calc=function(t,i){var e=i*(2*Math.PI/this.config.index.length),n=t*this.config.defaultRadius/this.edge,s=Math.PI/2;return{x:this.oX+n*Math.cos(e+s),y:this.oY+n*Math.sin(e+s)}},t.prototype.render=function(){this.fillPolygon().drawPolygon().drawRay().drawText()},t}(),g=function(){function t(t,i,e){this.g=null,this.config=null,this.items=null,this.oX=0,this.oY=0,this.edge=0,this.max=0,this.count=0,this.g=t,this.config=i,this.items=e,this.oX=this.config.canvasWidth/2,this.oY=this.config.canvasHeight/2,this.max=this.getMax(this.items),this.count=Math.floor(this.max/this.config.interval)+2,this.edge=this.count*this.config.interval}return t.prototype.getMax=function(t){return t.length?n(t.map(function(t){return t.value})):60},t.prototype.drawPolarNet=function(){for(var t=0,i=0;i<this.count;i++)t=(this.edge-i*this.config.interval)*this.config.defaultRadius/this.edge,new a(this.g,t,360,!1).render(this.oX,this.oY,"#ddd");return this},t.prototype.drawText=function(){var t=0;this.g.save(),this.g.font="12px serif";for(var i=0;i<this.count;i++)this.g.fillStyle="rgba(255, 255, 255, 0.5)",t=(this.edge-i*this.config.interval)*this.config.defaultRadius/this.edge,this.g.fillRect(this.oX-15,this.oY-t-10,30,20),this.g.fillStyle="#666",this.g.textAlign="center",this.g.textBaseline="middle",this.g.fillText(this.edge-i*this.config.interval,this.oX,this.oY-t);return this.g.restore(),this},t.prototype.calc=function(t){return t*this.config.defaultRadius/this.edge},t.prototype.render=function(){this.drawPolarNet().drawText()},t}(),u=!1,f=function(i,e,n){var s=null;!function r(){var o=!0;u=!0,i.map(function(t,i){var n=t[1]>t[0]?Math.ceil((t[1]-t[0])/5):Math.floor((t[1]-t[0])/5);t[0]+=n,e(n,i),t[0]!==t[1]&&(o=!1)}),o?(t.cancelAnimationFrame(s),u=!1,n()):s=t.requestAnimationFrame(r)}()},d=function(t,i,e,n,s){var r=0,o=[];if("BaseChart"===n.config.chartType||"PointChart"===n.config.chartType)return e(),n.setRenderOption(n.config.itemList).render(),!1;t.value instanceof Array?t.value[0]instanceof Array?("remove"===i&&(o=Array.from(new Array(t.value.length),function(i,e){return[Math.floor(t.value[e][1]),n.origin]})),"add"===i&&(o=Array.from(new Array(t.value.length),function(i,e){return r=Math.floor(t.value[e][1]),t.value[e][1]=n.origin,[n.origin,r]})),"set"===i&&(o=Array.from(new Array(t.value.length),function(i,e){return[Math.floor(t.value[e][1]),Math.floor(s[e][1])]})),f(o,function(i,e){t.value[e][1]+=i,n.setRenderOption(n.config.itemList).render()},e)):("remove"===i&&(o=Array.from(new Array(t.value.length),function(i,e){return[Math.floor(t.value[e]),n.origin]})),"add"===i&&(o=Array.from(new Array(t.value.length),function(i,e){return r=Math.floor(t.value[e]),t.value[e]=n.origin,[n.origin,r]})),"set"===i&&(o=Array.from(new Array(t.value.length),function(i,e){return[Math.floor(t.value[e]),Math.floor(s[e])]})),f(o,function(i,e){t.value[e]+=i,n.setRenderOption(n.config.itemList).render()},e)):("remove"===i&&(o=[[Math.floor(t.value),n.origin]]),"add"===i&&(r=Math.floor(t.value),t.value=n.origin,o=[[Math.floor(t.value),r]]),"set"===i&&(o=Array.from(new Array(t.value.length),function(i,e){return[Math.floor(t.value),Math.floor(s)]})),f(o,function(i,e){t.value+=i,n.setRenderOption(n.config.itemList).render()},e))},p=function(){function t(t,i){return this.g=null,this.config=null,this.data=[],this.items=[],this.coordinateSystem=null,this.radarSystem=null,this.polarSystem=null,this.origin=0,this.g=t,this.config=i,this.config.items?"PieChart"!==this.config.chartType&&"AnnularChart"!==this.config.chartType&&void 0===this.config.interval?(console.warn("'interval' option is required."),null):(this.config.grid=void 0===this.config.grid||this.config.grid,this.config.measureLine=void 0===this.config.measureLine||this.config.measureLine,this.bindMouseEvent(),void this.indexItem(this.config.items)):(console.warn("'items' option is required."),null)}return t.prototype.analyseItems=function(t,i){},t.prototype.bindMouseEvent=function(){var t=this;return this.config.canvas.addEventListener("mousemove",function(i){var e=i.clientX-t.config.canvas.getBoundingClientRect().left,n=i.clientY-t.config.canvas.getBoundingClientRect().top;t.g.clearRect(0,0,t.config.canvasWidth,t.config.canvasHeight),t.reRender(e,n)}),this},t.prototype.renderResult=function(t){},t.prototype.paintTipCase=function(t,i,e){},t.prototype.mouseSelect=function(t,i,e){},t.prototype.indexItem=function(t){return t.map(function(t,i){t.index=i}),this},t.prototype.reRender=function(t,i){},t.prototype.render=function(){var t=this;return this.g.clearRect(0,0,this.config.canvasWidth,this.config.canvasHeight),this.items.map(function(i,e){t.data.push({ele:t.analyseItems(i,e),color:i.color,label:i.label})}),this.reRender(0,0),this},t.prototype.setRenderOption=function(t){var i=this;return this.items=[],this.data=[],t.map(function(t){i.config.items.map(function(e){e.label===t&&i.items.push(e)})}),this.items.sort(function(t,i){return t.index-i.index}),this.coordinateSystem&&(this.coordinateSystem=new l(this.g,this.config,this.items),this.origin=this.coordinateSystem.yOrigin),this.radarSystem&&(this.radarSystem=new c(this.g,this.config,this.items)),this.polarSystem&&(this.polarSystem=new g(this.g,this.config,this.items)),"PieChart"===this.config.chartType||this.config.chartType,this},t.prototype.init=function(t){return this.setRenderOption(t).render(),this},t.prototype.addItem=function(t){this.config.items.push(t),this.config.itemList.push(t.label),r.createTagItem(this.config.tagCon,t,this.config),d(t,"add",function(){},this)},t.prototype.removeItem=function(t){var i=0,e=null;if(u)return!1;if(!this.config.items.length)return!1;t?this.config.items.map(function(n,s){n.label===t&&(i=s,e=n)}):(e=this.config.items[this.config.items.length-1],i=this.config.items.length-1);d(e,"remove",function(){this.config.items.splice(i,1),this.config.itemList.indexOf(e.label)>-1&&this.config.itemList.splice(this.config.itemList.indexOf(e.label),1),this.setRenderOption(this.config.itemList).render(),r.destoryTagItem(this.config.tagCon,t)}.bind(this),this)},t.prototype.setItem=function(t,i){var e=this.config.items[this.config.items.map(function(t){return t.label}).indexOf(t)];d(e,"set",function(){},this,i)},t}(),y=function(t){function i(i,e){var n=t.call(this,i,e)||this;return n.defaultRadius=3,n.coordinateSystem=!0,n.config.defaultRadius&&(n.defaultRadius=n.config.defaultRadius),n}return __extends(i,t),i.prototype.reRender=function(t,i){this.g.save(),this.paintGrid().drawCoordinateSystem().renderResult(this.data).paintTargetLineX(t,i).paintTargetLineY(t,i).paintTipCase(t,i,this.mouseSelect(this.data,t,i)),this.g.restore()},i.prototype.paintGrid=function(){return this.g.save(),this.config.grid&&this.drawGridX().drawGridY(),this.g.restore(),this},i.prototype.drawCoordinateSystem=function(){return this.coordinateSystem.rightAngle().setXIntervalPoint().setYIntervalPoint().baseLineX().baseLineY(),this},i.prototype.drawGridX=function(){for(var t=this.coordinateSystem.rxIntervals.length,i=this.coordinateSystem.ryEdge,e=0;e<t;e++)new o(this.g,this.coordinateSystem.rxIntervals[e],this.coordinateSystem.oY,"#eee").end(this.coordinateSystem.rxIntervals[e],i);return this},i.prototype.drawGridY=function(){for(var t=this.coordinateSystem.ryIntervals.length,i=this.coordinateSystem.rxEdge,e=0;e<t;e++)new o(this.g,this.coordinateSystem.oX,this.coordinateSystem.ryIntervals[e],"#eee").end(i,this.coordinateSystem.ryIntervals[e]);return this},i.prototype.isInChart=function(t,i){return t>this.coordinateSystem.oX&&t<this.coordinateSystem.rxEdge&&i<this.coordinateSystem.oY&&i>this.coordinateSystem.ryEdge},i.prototype.mouseSelect=function(t,i,e){var n=this,s=null;return t.map(function(t){"function"!=typeof t.ele&&t.ele.map(function(r){n.g.beginPath(),n.g.arc(r.x,r.y,r.r+2,0,2*Math.PI),n.g.isPointInPath(i,e)&&(n.g.save(),n.g.shadowOffsetX=1,n.g.shadowOffsetY=1,n.g.shadowBlur=2,n.g.shadowColor="rgba(0, 0, 0, 0.5)",n.g.fillStyle=t.color,n.g.fill(),n.g.restore(),s=r)})}),s},i.prototype.paintTargetLineY=function(t,i){var e=this.coordinateSystem.yOrigin+Math.abs(i-this.config.canvasHeight+45)*(this.coordinateSystem.yEdge-this.coordinateSystem.yOrigin)/this.coordinateSystem.lY;return this.g.save(),this.g.setLineDash([4,2]),this.isInChart(t,i)&&this.config.measureLine&&(new o(this.g,this.coordinateSystem.oX,i,"rgba(0, 0, 0, 0.2)").end(this.coordinateSystem.rxEdge,i),this.g.fillStyle="rgba(0, 0, 0, 0.7)",this.g.rect(this.coordinateSystem.oX+5,i-21,70,18),this.g.fill(),this.g.font="12px serif",this.g.fillStyle="#fff",this.g.fillText("y: "+e.toFixed(3),this.coordinateSystem.oX+10,i-9)),this.g.restore(),this},i.prototype.paintTargetLineX=function(t,i){var e=this.coordinateSystem.xOrigin+(t-45)*(this.coordinateSystem.xEdge-this.coordinateSystem.xOrigin)/this.coordinateSystem.lX;return this.g.save(),this.g.setLineDash([4,2]),this.isInChart(t,i)&&this.config.measureLine&&(new o(this.g,t,this.coordinateSystem.ryEdge,"rgba(0, 0, 0, 0.2)").end(t,this.coordinateSystem.oY),this.g.fillStyle="rgba(0, 0, 0, 0.7)",this.g.rect(t+5,this.coordinateSystem.oY-21,70,18),this.g.fill(),this.g.font="12px serif",this.g.fillStyle="#fff",this.g.fillText("x: "+e.toFixed(3),t+10,this.coordinateSystem.oY-8)),this.g.restore(),this},i.prototype.paintTipCase=function(t,i,e){this.coordinateSystem.xOrigin,this.coordinateSystem.xEdge,this.coordinateSystem.xOrigin,this.coordinateSystem.lX,this.coordinateSystem.yOrigin,Math.abs(i-this.config.canvasHeight+45),this.coordinateSystem.yEdge,this.coordinateSystem.yOrigin,this.coordinateSystem.lY;return this.isInChart(t,i)&&(this.g.fillStyle="rgba(0, 0, 0, 0.7)",t+90>this.coordinateSystem.rxEdge&&(t=this.coordinateSystem.rxEdge-90),e&&(this.g.fillRect(t+10,i+10,80,40),this.g.font="12px serif",this.g.fillStyle="#fff",this.g.fillText("x: "+e.cx.toFixed(3),t+15,i+25),this.g.fillText("y: "+e.cy.toFixed(3),t+15,i+40))),this},i.prototype.analyseItems=function(t,i){var e=this,n=[];return"function"==typeof t.value?t.value:(t.value.map(function(t,i){var s=e.coordinateSystem.calc(t[0],t[1]);n.push({x:s.x,y:s.y,cx:t[0],cy:t[1],r:3})}),n)},i.prototype.renderPoints=function(t,i){for(var e=new a(this.g,this.defaultRadius,360),n=new o(this.g,t[0].x,t[0].y,i).paint(e),s=1,r=t.length;s<r;s++)s===r?n.next(t[s].x,t[s].y).paint(e):n.end(t[s].x,t[s].y).paint(e)},i.prototype.renderExpression=function(t,i){for(var e=this.coordinateSystem.xOrigin,n=this.coordinateSystem.calc(e,t(e)),s=new o(this.g,n.x,n.y,i);e<this.coordinateSystem.xEdge;)e+=.02,n=this.coordinateSystem.calc(e,t(e)),e>this.coordinateSystem.xEdge||t(e)>this.coordinateSystem.yEdge||t(e)<this.coordinateSystem.yOrigin||e<this.coordinateSystem.xOrigin?s.next(n.x,n.y,"transparent"):s.next(n.x,n.y,i);s.end(n.x,n.y)},i.prototype.renderResult=function(t){var i=this;return t.map(function(t){"function"==typeof t.ele?i.renderExpression(t.ele,t.color):i.renderPoints(t.ele,t.color)}),this},i}(p),m=function(t){function i(i,e){return t.call(this,i,e)||this}return __extends(i,t),i.prototype.getRadius=function(t){var i=this,e=[],n=0;return t.map(function(t){t&&e.push(t)}),n=e.length?s(e):1,(t=t.map(function(t){return void 0===t&&(t=n),t})).map(function(t){return Math.sqrt(t/n)*i.defaultRadius})},i.prototype.analyseItems=function(t,i){var e=this,n=this.getRadius(t.value.map(function(t){return t[2]})),s=[];return t.value.map(function(t,i){var r=e.coordinateSystem.calc(t[0],t[1]);s.push({x:r.x,y:r.y,r:n[i],w:t[2],cx:t[0],cy:t[1]})}),s},i.prototype.renderResult=function(t){var i=this;return this.g.save(),this.g.globalAlpha=.8,t.map(function(t){t.ele.map(function(e){new a(i.g,e.r,360).render(e.x,e.y,t.color)})}),this.g.restore(),this},i.prototype.paintTipCase=function(t,i,e){this.coordinateSystem.xEdge,this.coordinateSystem.xOrigin,this.coordinateSystem.lX,Math.abs(i-this.config.canvasHeight+45),this.coordinateSystem.yEdge,this.coordinateSystem.yOrigin,this.coordinateSystem.lY;return this.g.fillStyle="rgba(0, 0, 0, 0.7)",t+90>this.coordinateSystem.rxEdge&&(t=this.coordinateSystem.rxEdge-90),this.isInChart(t,i)&&e&&(this.g.fillRect(t+10,i+10,80,55),this.g.font="12px serif",this.g.fillStyle="#fff",this.g.fillText("x: "+e.cx.toFixed(3),t+15,i+25),this.g.fillText("y: "+e.cy.toFixed(3),t+15,i+40),this.g.fillText("weight: "+(e.w?e.w:"none"),t+15,i+55)),this},i}(y),v=function(t){function i(i,e){var n=t.call(this,i,e)||this;return n.length=0,n.interval=0,n.defaultRadius=4.5,void 0===n.config.xAxis?(console.warn("'xAxis' option is required."),null):(n.length=n.config.xAxis.length,n.config.length=n.length,n.checkDataIsComplete(n.config.items),n)}return __extends(i,t),i.prototype.reRender=function(t,i){this.g.save(),this.drawXaxis().paintGrid().drawCoordinateSystem().renderResult(this.data).paintTargetLineY(t,i).paintTipCase(t,i,this.mouseSelect(this.data,t,i)),this.g.restore()},i.prototype.checkDataIsComplete=function(t){var i=this,e=0;return t.map(function(t){if((e=i.length-t.value.length)>0)for(;e--;)t.value.push(0)}),this},i.prototype.analyseItems=function(t,i){var e=this,n=[];return t.value.map(function(t,s){var r=e.data.length>0?e.data[i-1].ele[s].cy+t:t,o=e.coordinateSystem.calc(0,r);n.push({y:o.y,cy:r,count:t})}),n},i.prototype.paintTipCase=function(t,i,e){var n=this,s=0;return t+90>this.coordinateSystem.rxEdge+20&&(t=this.coordinateSystem.rxEdge-70),this.isInChart(t,i)&&(this.g.fillStyle="rgba(0, 0, 0, 0.7)",e&&(this.g.fillRect(t+15,i,80,35+20*this.items.length),this.g.font="12px serif",this.g.fillStyle="#fff",this.g.fillText(e.xLabel,t+20,i+15),e.points.map(function(e,r){n.g.fillText(e.label+": "+e.p.count,t+20,18+i+17*(r+1)),s+=e.p.count}),this.g.fillText("total: "+s,t+20,i+25+20*this.items.length),s=0)),this},i.prototype.mouseSelect=function(t,i,e){var n=this,s=null;return this.g.strokeStyle="#000",this.g.setLineDash([4,2]),this.g.strokeStyle="#666",this.items.length&&t[0].ele.map(function(r,h){n.g.beginPath(),n.g.rect(r.x-n.interval/2,n.coordinateSystem.ryEdge,n.interval,n.coordinateSystem.lY),n.g.isPointInPath(i,e)&&(new o(n.g,r.x,n.coordinateSystem.ryEdge).end(r.x,n.coordinateSystem.oY),t.map(function(t){return{p:t.ele[h],color:t.color}}).map(function(t){new a(n.g,Math.floor(1.4*n.defaultRadius),360).render(t.p.x,t.p.y,t.color)}),s={points:t.map(function(t){return{p:t.ele[h],label:t.label}}),xLabel:n.config.xAxis[h]})}),s},i.prototype.paintGrid=function(){return this.g.save(),this.config.grid&&this.drawGridY(),this.g.restore(),this},i.prototype.drawCoordinateSystem=function(){return this.coordinateSystem.rightAngle().setYIntervalPoint().baseLineX(),this},i.prototype.drawXaxis=function(){var t=this,i=this.coordinateSystem.lX/(this.length-1);return this.interval=i,this.g.save(),this.g.textAlign="center",this.config.xAxis.map(function(e,n){var s=t.coordinateSystem.oX+n*i;new o(t.g,s,t.coordinateSystem.oY).end(s,t.coordinateSystem.oY+5),t.data.map(function(t){t.ele[n].x=s}),t.g.fillText(e,s,t.coordinateSystem.oY+25)}),this.g.restore(),this},i.prototype.renderResult=function(t){var i=this;this.g.save();for(var e=0;e<t.length;e++)for(var n=null,s=t[e],r=e>0?t[e-1]:s,h=0;h<s.ele.length;h++){var l=s.ele[h],c=r.ele[h];if(this.g.fillStyle=s.color,this.g.globalAlpha=.5,0===e)n=0===h?new o(this.g,this.coordinateSystem.oX,this.coordinateSystem.oY,r.color).next(c.x,c.y):h===r.ele.length-1?n.next(c.x,c.y).end(this.coordinateSystem.rxEdge,this.coordinateSystem.oY,!0):n.next(c.x,c.y);else if(0===h)n=new o(this.g,c.x,c.y,s.color).next(l.x,l.y);else if(h===s.ele.length-1){n=n.next(l.x,l.y);for(var g=r.ele.length-1;g>=0;g--)n=n.next(r.ele[g].x,r.ele[g].y);n.end(s.ele[0].x,s.ele[0].y,!0)}else n=n.next(l.x,l.y)}return this.g.restore(),t.map(function(t){t.ele.map(function(e){new a(i.g,i.defaultRadius,360).render(e.x,e.y,t.color)})}),this},i}(y),x=function(t){function e(i,e){var n=t.call(this,i,e)||this;return n.width=0,n.config.trendLine=void 0!==n.config.trendLine&&n.config.trendLine,n}return __extends(e,t),e.prototype.analyseItems=function(t,i){var e=this,n=[];return this.interval=this.coordinateSystem.lX/this.length,this.width=this.interval/(2*this.items.length+1),t.value.map(function(t,s){var r=e.coordinateSystem.oX+s*e.interval+e.width*(2*i+1),o=e.coordinateSystem.oY-e.coordinateSystem.calc(0,t).y;n.push({x:r,y:e.coordinateSystem.oY-o,width:e.width,height:o,value:t})}),n},e.prototype.paintTipCase=function(t,i,e){var n=this;return t+90>this.coordinateSystem.rxEdge+20&&(t=this.coordinateSystem.rxEdge-70),this.isInChart(t,i)&&(this.g.fillStyle="rgba(0, 0, 0, 0.7)",e.data.length&&(this.g.fillRect(t+15,i,80,25+20*this.items.length),this.g.font="12px serif",this.g.fillStyle="#fff",this.g.fillText(e.xLabel,t+20,i+15),e.data.map(function(e,s){n.g.fillText(e.label+": "+e.value,t+20,i+35+20*s)}))),this},e.prototype.mouseSelect=function(t,e,n){var s={data:[],xLabel:""};if(this.items.length)for(var r=function(r){var a=o.coordinateSystem.oX+r*o.interval;o.g.beginPath(),o.g.rect(a,o.coordinateSystem.ryEdge,o.interval,o.coordinateSystem.lY),o.g.isPointInPath(e,n)&&(o.g.save(),o.g.fillStyle=i.defaultColor,o.g.globalAlpha=.1,o.g.fill(),t.map(function(t){s.data.push({value:t.ele[r].value,label:t.label})}),s.xLabel=o.config.xAxis[r],o.g.restore())},o=this,a=0;a<this.length;a++)r(a);return s},e.prototype.drawXaxis=function(){var t=this,i=this.interval;return this.g.save(),this.g.textAlign="center",this.config.xAxis.map(function(e,n){var s=t.coordinateSystem.oX+n*i;new o(t.g,s,t.coordinateSystem.oY).end(s,t.coordinateSystem.oY+5),t.g.fillText(e,s+i/2,t.coordinateSystem.oY+25)}),this.g.restore(),this},e.prototype.renderResult=function(t){var i=this;return t.map(function(t,e){t.ele.map(function(e,n){new h(i.g,e.width,e.height).render(e.x,e.y,t.color)})}),this},e}(v),S=function(t){function i(i,e){return t.call(this,i,e)||this}return __extends(i,t),i.prototype.drawXaxis=function(){var t=this,i=this.interval;return this.g.save(),this.g.textAlign="center",this.config.xAxis.map(function(e,n){var s=t.coordinateSystem.oX+(n+1)*i;new o(t.g,s,t.coordinateSystem.oY).end(s,t.coordinateSystem.oY+5),t.data.map(function(t){t.ele[n].x=s}),t.g.fillText(e,s,t.coordinateSystem.oY+25)}),this.g.restore(),this},i.prototype.analyseItems=function(t,i){var e=this,n=[];return this.interval=this.coordinateSystem.lX/(this.length+1),t.value.map(function(t,i){var s=e.coordinateSystem.calc(0,t),r=e.coordinateSystem.oX+e.interval+e.interval*i;n.push({x:r,y:s.y,value:t})}),n},i.prototype.paintTipCase=function(t,i,e){var n=this;return t+90>this.coordinateSystem.rxEdge+20&&(t=this.coordinateSystem.rxEdge-70),this.isInChart(t,i)&&(this.g.fillStyle="rgba(0, 0, 0, 0.7)",e&&(this.g.fillRect(t+15,i,80,20+20*this.items.length),this.g.font="12px serif",this.g.fillStyle="#fff",this.g.fillText(e.xLabel,t+20,i+15),e.points.map(function(e,s){n.g.fillText(e.label+": "+e.p.value,t+20,18+i+17*(s+1))}))),this},i.prototype.renderResult=function(t){var i=this,e=null,n=new a(this.g,this.defaultRadius,360);return t.map(function(t,s){t.ele.map(function(s,r){(e=0===r?new o(i.g,s.x,s.y,t.color):r===t.ele.length-1?e.end(s.x,s.y):e.next(s.x,s.y)).paint(n)})}),this},i}(v),w=function(t){function i(i,e){var n=t.call(this,i,e)||this;return n.radius=120,n.centerPoint=[],n.total=0,n.config.radius=void 0===n.config.radius?n.radius:n.config.radius,n.centerPoint=[n.config.canvasWidth/2,n.config.canvasHeight/2],n}return __extends(i,t),i.prototype.analyseItems=function(t,i){return 0===i&&(this.total=function(t){return t.length?t.reduce(function(t,i,e,n){return t+i}):0}(this.items.map(function(t){return t.value}))),{value:t.value,angle:360*t.value/this.total,ratio:(t.value/this.total*100).toFixed(1)+"%"}},i.prototype.renderResult=function(t){var i=this,n=null,s=0,r=0;return this.g.save(),this.g.globalAlpha=.8,t.map(function(t){n=n?n.next(t.ele.angle,t.color):new a(i.g,i.config.radius,t.ele.angle).render(i.centerPoint[0],i.centerPoint[1],t.color)}),this.g.strokeStyle="#fff",this.g.lineWidth=1.5,t.map(function(t,n){0===n?(s=0,r=t.ele.angle):r=(s=r)+t.ele.angle,i.g.beginPath(),i.g.moveTo(i.centerPoint[0],i.centerPoint[1]),i.g.arc(i.centerPoint[0],i.centerPoint[1],i.config.radius,e(s),e(r)),i.g.closePath(),i.g.stroke()}),this.g.restore(),this},i.prototype.isInCircle=function(t,i){return this.g.beginPath(),this.g.arc(this.centerPoint[0],this.centerPoint[1],this.config.radius,0,2*Math.PI),this.g.isPointInPath(t,i)},i.prototype.paintTipCase=function(t,i,e){return this.isInCircle(t,i)&&(this.g.fillStyle="rgba(0, 0, 0, 0.5)",e&&(this.g.fillRect(t,i-60,110,50),this.g.font="12px serif",this.g.fillStyle="#fff",this.g.fillText("lable: "+e.label,t+10,i-45),this.g.fillText("data: "+e.ele.value,t+10,i-30),this.g.fillText("ratio: "+e.ele.ratio,t+10,i-15))),this},i.prototype.mouseSelect=function(t,i,n){var s=this,r=null,o=0,a=0;return t.map(function(t,h){s.g.save(),s.g.fillStyle=t.color,0===h?(o=0,a=t.ele.angle):a=(o=a)+t.ele.angle,s.g.beginPath(),s.g.moveTo(s.centerPoint[0],s.centerPoint[1]),s.g.arc(s.centerPoint[0],s.centerPoint[1],s.config.radius+.15*s.config.radius,e(o),e(a)),s.g.closePath(),s.g.isPointInPath(i,n)&&(s.g.shadowOffsetX=2,s.g.shadowOffsetY=2,s.g.shadowBlur=8,s.g.shadowColor="rgba(0, 0, 0, 0.5)",s.g.fill(),r=t),s.g.restore()}),r},i.prototype.reRender=function(t,i){this.g.save(),this.renderResult(this.data).paintTipCase(t,i,this.mouseSelect(this.data,t,i)),this.g.restore()},i}(p),P=function(t){function i(i,e){var n=t.call(this,i,e)||this;return n.width=65,n.config.width=void 0===n.config.width?n.width:n.config.width,n}return __extends(i,t),i.prototype.drawCenterCircle=function(){return new a(this.g,this.config.radius-this.config.width,360).render(this.centerPoint[0],this.centerPoint[1],"#fff"),this},i.prototype.mouseSelect=function(t,i,n){var s=this,r=null,o=0,a=0;return this.g.strokeStyle="#000",t.map(function(t,h){0===h?(o=0,a=t.ele.angle):a=(o=a)+t.ele.angle,s.isInAnnular(i,n)&&(s.g.beginPath(),s.g.moveTo(s.centerPoint[0],s.centerPoint[1]),s.g.arc(s.centerPoint[0],s.centerPoint[1],s.config.radius,e(o),e(a)),s.g.closePath(),s.g.isPointInPath(i,n)&&(s.g.save(),s.g.globalAlpha=.5,s.g.fill(),r=t,s.g.restore()))}),r},i.prototype.isInAnnular=function(t,i){var e=!1,n=!1;return this.g.beginPath(),this.g.arc(this.centerPoint[0],this.centerPoint[1],this.config.radius,0,2*Math.PI),this.g.isPointInPath(t,i)&&(e=!0),this.g.beginPath(),this.g.arc(this.centerPoint[0],this.centerPoint[1],this.config.radius-this.config.width,0,2*Math.PI),this.g.isPointInPath(t,i)||(n=!0),n&&e},i.prototype.paintTipCase=function(t,i,e){return this.drawCenterCircle(),this.isInAnnular(t,i)&&(this.g.fillStyle="rgba(0, 0, 0, 0.5)",e&&(this.g.fillRect(t,i-60,110,50),this.g.font="12px serif",this.g.fillStyle="#fff",this.g.fillText("lable: "+e.label,t+10,i-45),this.g.fillText("data: "+e.ele.value,t+10,i-30),this.g.fillText("ratio: "+e.ele.ratio,t+10,i-15))),this},i}(w),C=function(t){function i(i,e){var n=t.call(this,i,e)||this;return n.defaultRadius=200,n.length=0,n.radarSystem=!0,void 0===n.config.index?(console.warn("'index' option is required."),null):(n.defaultRadius=void 0===n.config.radius?n.defaultRadius:n.config.radius,n.config.defaultRadius=n.defaultRadius,n.length=n.config.index.length,n.config.centerX=n.config.canvasWidth/2,n.config.centerY=n.config.canvasHeight/2,n.checkDataIsComplete(n.config.items),n)}return __extends(i,t),i.prototype.checkDataIsComplete=function(t){var i=this,e=0;return t.map(function(t){if((e=i.length-t.value.length)>0)for(;e--;)t.value.push(0)}),this},i.prototype.drawRadarNet=function(t){return this.radarSystem.render(),this},i.prototype.analyseItems=function(t,i){var e=this,n=[];return t.value.map(function(t,i){var s=e.radarSystem.calc(t,i);n.push({x:s.x,y:s.y,value:t})}),n},i.prototype.renderResult=function(t){var i=this,e=null;return this.g.save(),this.g.globalAlpha=.7,t.map(function(t){i.g.fillStyle=t.color,t.ele.map(function(n,s){e=0===s?new o(i.g,n.x,n.y,t.color):s===t.ele.length-1?e.end(n.x,n.y,!0):e.next(n.x,n.y)})}),this.g.restore(),t.map(function(t){t.ele.map(function(e){new a(i.g,3,360).render(e.x,e.y,t.color)})}),this},i.prototype.paintTipCase=function(t,i,e){var n=this;return this.g.fillStyle="rgba(0, 0, 0, 0.5)",e&&(this.g.fillRect(t+15,i,110,30+20*this.config.index.length),this.g.font="12px serif",this.g.fillStyle="#fff",this.g.fillText("lable: "+e.label,t+20,i+20),this.config.index.map(function(s,r){n.g.fillText(s+": "+e.ele[r].value,t+20,i+40+20*r)})),this},i.prototype.mouseSelect=function(t,i,e){var n=this,s=null;return t.map(function(t,r){n.g.save(),n.g.fillStyle=t.color,n.g.beginPath(),t.ele.map(function(t,i){0===i?n.g.moveTo(t.x,t.y):n.g.lineTo(t.x,t.y)}),n.g.closePath(),n.g.isPointInPath(i,e)&&(n.g.globalAlpha=.7,n.g.fill(),s=t),n.g.restore()}),s},i.prototype.reRender=function(t,i){this.g.save(),this.drawRadarNet(this.config.index).renderResult(this.data).paintTipCase(t,i,this.mouseSelect(this.data,t,i)),this.g.restore()},i}(p),T=function(t){function i(i,e){var n=t.call(this,i,e)||this;return n.defaultRadius=250,n.polarSystem=!0,n.margin=2,n.defaultRadius=void 0===n.config.radius?n.defaultRadius:n.config.radius,n.config.defaultRadius=n.defaultRadius,n}return __extends(i,t),i.prototype.drawPolarNet=function(){return this.polarSystem.render(),this},i.prototype.isInCircle=function(t,i){return this.g.beginPath(),this.g.arc(this.polarSystem.oX,this.polarSystem.oY,this.defaultRadius,0,2*Math.PI),this.g.isPointInPath(t,i)},i.prototype.paintTargetLine=function(t,i){var e=Math.sqrt(Math.abs(Math.pow(t-this.polarSystem.oX,2)+Math.pow(i-this.polarSystem.oY,2)));return this.isInCircle(t,i)&&(this.g.save(),this.g.setLineDash([4,2]),new a(this.g,e,360,!1).render(this.polarSystem.oX,this.polarSystem.oY,"#bbb"),new o(this.g,this.polarSystem.oX,this.polarSystem.oY,"#bbb").end(t,i),this.g.restore()),this},i.prototype.mouseSelect=function(t,i,e){var n=this,s=null,r=2*Math.PI/this.items.length;return this.g.save(),this.g.translate(this.polarSystem.oX,this.polarSystem.oY),t.map(function(t,o){n.g.fillStyle=t.color,n.g.rotate(r),n.g.beginPath(),n.g.moveTo(3,3),n.g.arc(3,3,Math.abs(t.ele.radius-n.margin),0,r),n.g.closePath(),n.g.isPointInPath(i,e)&&(n.g.fill(),s=t)}),this.g.restore(),s},i.prototype.paintTipCase=function(t,i,e){var n=Math.sqrt(Math.abs(Math.pow(t-this.polarSystem.oX,2)+Math.pow(i-this.polarSystem.oY,2)));return this.g.fillStyle="rgba(0, 0, 0, 0.5)",this.g.font="12px serif",this.isInCircle(t,i)&&(e?(this.g.fillRect(t+15,i,80,50),this.g.font="12px serif",this.g.fillStyle="#fff",this.g.fillText("lable: "+e.label,t+20,i+20),this.g.fillText("value: "+e.ele.value,t+20,i+40)):(this.g.fillRect(t+15,i,50,20),this.g.fillStyle="#fff",this.g.fillText((n*this.polarSystem.edge/this.defaultRadius).toFixed(2),t+20,i+15))),this},i.prototype.reRender=function(t,i){this.g.save(),this.drawPolarNet().renderResult(this.data).paintTargetLine(t,i).paintTipCase(t,i,this.mouseSelect(this.data,t,i)),this.g.restore()},i.prototype.analyseItems=function(t){return{radius:this.polarSystem.calc(t.value),value:t.value}},i.prototype.renderResult=function(t){var i=this,e=2*Math.PI/this.items.length,n=(Math.PI,this.margin),s=this.margin;return this.g.save(),this.g.translate(this.polarSystem.oX,this.polarSystem.oY),this.g.globalAlpha=.5,t.map(function(t,r){i.g.rotate(e),new a(i.g,Math.abs(t.ele.radius-i.margin),360/i.items.length).render(n,s,t.color)}),this.g.restore(),this},i}(p);return r.extend({chartType:"BaseChart",chartClass:y}),r.extend({chartType:"PointChart",chartClass:m}),r.extend({chartType:"PillarChart",chartClass:x}),r.extend({chartType:"LineChart",chartClass:S}),r.extend({chartType:"AreaChart",chartClass:v}),r.extend({chartType:"PieChart",chartClass:w}),r.extend({chartType:"AnnularChart",chartClass:P}),r.extend({chartType:"RadarChart",chartClass:C}),r.extend({chartType:"PolarChart",chartClass:T}),t.Chart=r,r}(window);